# Project Structure

## Top-Level Layout

```
project/
├── src/
│   ├── lib/                  # Shared library code
│   │   ├── components/       # Reusable Svelte components
│   │   │   └── ui/           # shadcn-svelte components
│   │   ├── server/           # Server-only code
│   │   │   ├── db/           # Drizzle database setup
│   │   │   │   ├── index.ts  # Database client (Neon + Drizzle)
│   │   │   │   └── schema.ts # Drizzle table schemas
│   │   │   └── auth.ts       # Lucia authentication setup
│   │   ├── stores/           # Svelte stores
│   │   ├── queries/          # TanStack Query hooks
│   │   ├── utils/            # Utility functions
│   │   ├── schemas/          # Zod schemas (+ drizzle-zod generated)
│   │   └── types/            # TypeScript types
│   ├── routes/               # SvelteKit routes (pages + API)
│   │   ├── +layout.svelte    # Root layout (QueryClientProvider)
│   │   ├── +page.svelte      # Home page
│   │   ├── api/              # API endpoints (+server.ts)
│   │   ├── (auth)/           # Auth routes (login, register, logout)
│   │   └── (protected)/      # Protected routes (require auth)
│   ├── hooks.server.ts       # SvelteKit hooks (Lucia session handling)
│   └── app.html              # HTML template
├── static/                   # Static assets
├── tests/
│   ├── unit/                 # Unit tests (Vitest)
│   ├── e2e/                  # E2E tests (Playwright)
│   ├── mocks/                # MSW mock handlers
│   └── setup.ts              # Test setup (MSW server)
├── drizzle/                  # Drizzle migrations
│   └── migrations/           # SQL migration files
├── src-tauri/                # Tauri desktop app (Rust)
└── docs/                     # Documentation
    └── llm/                  # LLM context and guidelines
```

## Key Directories

### `/src/lib` - Shared Library Code
- `components/` - Reusable UI components
- `components/ui/` - shadcn-svelte primitives
- `server/` - Server-only utilities
- `server/db/` - Drizzle database client and schemas
- `server/auth.ts` - Lucia authentication configuration
- `stores/` - Svelte stores for reactive state
- `queries/` - TanStack Query hooks for data fetching
- `utils/` - Pure utility functions
- `schemas/` - Zod validation schemas
- `types/` - TypeScript type definitions

### `/src/routes` - SvelteKit Routes
- `+page.svelte` - Page components
- `+page.server.ts` - Server load functions
- `+server.ts` - API endpoints
- `+layout.svelte` - Layout components
- `+error.svelte` - Error pages
- `(auth)/` - Route group for authentication pages
- `(protected)/` - Route group for authenticated pages

### `/src-tauri` - Tauri Desktop App
- Rust source code for desktop features
- Native file system access
- System tray and menu integration
- Desktop-specific functionality

### `/drizzle` - Database Migrations
- `migrations/` - SQL migration files
- Generated by `pnpm db:generate`
- Applied with `pnpm db:migrate`

### `/tests` - Test Files
- `unit/` - Vitest unit tests
- `e2e/` - Playwright E2E tests
- `mocks/` - MSW mock handlers
- `setup.ts` - Test configuration

## Naming Conventions

- **Components:** PascalCase (`NoteEditor.svelte`, `FileTree.svelte`)
- **Routes:** lowercase with hyphens (`/daily-notes`, `/tag-view`)
- **Utilities:** camelCase (`parseMarkdown.ts`, `extractTags.ts`)
- **Stores:** camelCase (`noteStore.ts`, `authStore.ts`)
- **Queries:** camelCase with `use` prefix (`useNotes.ts`, `useCreateNote.ts`)
- **Schemas:** camelCase with Schema suffix (`noteSchema.ts`)
- **Tests:** mirror source with `.test.ts` or `.spec.ts` suffix
- **Drizzle tables:** camelCase in code, snake_case in database

## Build & Package

- `pnpm dev` - Development mode with HMR
- `pnpm build` - Production build (SvelteKit)
- `pnpm tauri dev` - Tauri desktop development
- `pnpm tauri build` - Create desktop app bundles
- Environment configuration in `.env` files

## Cloudflare Deployment

- Cloudflare Pages for hosting
- `staging` branch → Preview deployment
- `main` branch → Production deployment
- Cloudflare R2 for file storage
- Cloudflare CDN-CGI/Image for image optimization
